<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title></title>

	<link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="css/font.css" />
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<link rel="stylesheet" href="css/photoswipe.css">
	<link rel="stylesheet" href="css/default-skin/default-skin.css">

	<script src="js/jquery-1.11.3.min.js"></script>
    <!--<script src="phonegap.js"></script>-->
    <script src="js/fastclick.js"></script>
    <script src="js/back_btn.js"></script>
    <script src="js/main.js"></script>
    <script src="js/hammer.min.js"></script>
    <script src="css/photoswipe.min.js"></script>
    <script src="css/photoswipe-ui-default.min.js"></script>

	<script>

		function init() {
			document.addEventListener("deviceready", onDeviceReady, false);
			//var mc = new Hammer(document.body);
			var mc1 = new Hammer(document.getElementById("gallery_toch1"));
			var mc2 = new Hammer(document.getElementById("gallery_toch2"));
			var mc3 = new Hammer(document.getElementById("ajax"));
			mc1.on("swiperight", function(ev) {go_back();});
			mc2.on("swiperight", function(ev) {go_back();});
			mc3.on("swiperight", function(ev) {go_back();});

/**/
				$.ajax({
						url: "http://app.irdmfestival.ir/news/out.php?act=multimedia&id=" + getParameterByName("id"),
						type: "POST",
						data: {
							testdata: "786"
						},
						async: true,
						success : function(text)
						{						
							$(".akhbar_inner_content2").html(text);
							//window.localStorage.setItem('MultiList',text);
							FastClick.attach(document.body);
							initPhotoSwipeFromDOM('.my-gallery');
							$('img').on('dragstart', function(event) { event.preventDefault();				});
							$('a').on('dragstart', function(event) { event.preventDefault();				});
							$(".mypreload").html("");
						},
						error: function(jqXHR, exception) {
							if (jqXHR.status === 0) {
								$('.container').html('در اتصال شما به اینترنت مشکلی به وجود آمده است ، امکان نمایش محتوا وجود ندارد<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (jqXHR.status == 404) {
								$('.container').html('صفحه مورد نظر شما یافت نشد<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (jqXHR.status == 500) {
								$('.container').html('Internal Server Error [500].<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (exception === 'parsererror') {
								$('.container').html('Requested JSON parse failed.<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (exception === 'timeout') {
								$('.container').html('Time out error.<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (exception === 'abort') {
								$('.container').html('Ajax request aborted.<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else {
								$('.container').html('Uncaught Error.\n' + jqXHR.responseText + '<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							}
						},
						//error : function (request, status, error) {
						//	alert(request.responseText);
						//}
				});

			
		  // execute above function
		  // initPhotoSwipeFromDOM('.my-gallery');
		}
		function onDeviceReady() {
			var networkState = navigator.connection.type;
			if (networkState != Connection.NONE)
			{
				$.ajax({
						url: "http://app.irdmfestival.ir/news/out.php?act=multimedia&id=" + getParameterByName("id"),
						type: "POST",
						data: {
							testdata: "786"
						},
						async: true,
						success : function(text)
						{						
							$(".akhbar_inner_content2").html(text);
							//window.localStorage.setItem('MultiList',text);
							FastClick.attach(document.body);
							initPhotoSwipeFromDOM('.my-gallery');
							$('img').on('dragstart', function(event) { event.preventDefault();				});
							$('a').on('dragstart', function(event) { event.preventDefault();				});
							$(".mypreload").html("");
						},
						error: function(jqXHR, exception) {
							if (jqXHR.status === 0) {
								$('.container').html('در اتصال شما به اینترنت مشکلی به وجود آمده است ، امکان نمایش محتوا وجود ندارد<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (jqXHR.status == 404) {
								$('.container').html('صفحه مورد نظر شما یافت نشد<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (jqXHR.status == 500) {
								$('.container').html('Internal Server Error [500].<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (exception === 'parsererror') {
								$('.container').html('Requested JSON parse failed.<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (exception === 'timeout') {
								$('.container').html('Time out error.<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else if (exception === 'abort') {
								$('.container').html('Ajax request aborted.<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							} else {
								$('.container').html('Uncaught Error.\n' + jqXHR.responseText + '<a onclick="go_back();" style="position: fixed; color: white; text-align: center; box-sizing: padding-box; top: 45%; background-color: black; z-index: 99999999; width: 100%; left: 0px; padding: 20px 0px;">بازگشت به صفحه قبل</a>');
							}
						},
						//error : function (request, status, error) {
						//	alert(request.responseText);
						//}
				});
			}
			else
			{
				navigator.notification.alert(
					'شما برای مشاهده این صفحه، به اینترنت نیاز دارید',	// message
					goto_home,			// callback
					'اخطار',			// title
					'تائید'				// buttonName
				);
			}
			

			

			
			if ( device.platform == 'Android' ){//Android,iOS,win7=WinCE,win8=Win32NT
				document.addEventListener("backbutton", go_back, false);
			}
		}
		
		
		
		
		
		
		
		
		var initPhotoSwipeFromDOM = function(gallerySelector) {

		  // parse slide data (url, title, size ...) from DOM elements
		  // (children of gallerySelector)
		  var parseThumbnailElements = function(el) {
			  var thumbElements = el.childNodes,
				  numNodes = thumbElements.length,
				  items = [],
				  figureEl,
				  linkEl,
				  size,
				  item;

			  for(var i = 0; i < numNodes; i++) {

				  figureEl = thumbElements[i]; // <figure> element

				  // include only element nodes
				  if(figureEl.nodeType !== 1) {
					  continue;
				  }

				  linkEl = figureEl.children[0]; // <a> element

				  size = linkEl.getAttribute('data-size').split('x');

				  // create slide object
				  item = {
					  src: linkEl.getAttribute('href'),
					  w: parseInt(size[0], 10),
					  h: parseInt(size[1], 10)
				  };



				  if(figureEl.children.length > 1) {
					  // <figcaption> content
					  item.title = figureEl.children[1].innerHTML;
				  }

				  if(linkEl.children.length > 0) {
					  // <img> thumbnail element, retrieving thumbnail url
					  item.msrc = linkEl.children[0].getAttribute('src');
				  }

				  item.el = figureEl; // save link to element for getThumbBoundsFn
				  items.push(item);
			  }

			  return items;
		  };

		  // find nearest parent element
		  var closest = function closest(el, fn) {
			  return el && ( fn(el) ? el : closest(el.parentNode, fn) );
		  };

		  // triggers when user clicks on thumbnail
		  var onThumbnailsClick = function(e) {
			  e = e || window.event;
			  e.preventDefault ? e.preventDefault() : e.returnValue = false;

			  var eTarget = e.target || e.srcElement;

			  // find root element of slide
			  var clickedListItem = closest(eTarget, function(el) {
				  return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');
			  });

			  if(!clickedListItem) {
				  return;
			  }

			  // find index of clicked item by looping through all child nodes
			  // alternatively, you may define index via data- attribute
			  var clickedGallery = clickedListItem.parentNode,
				  childNodes = clickedListItem.parentNode.childNodes,
				  numChildNodes = childNodes.length,
				  nodeIndex = 0,
				  index;

			  for (var i = 0; i < numChildNodes; i++) {
				  if(childNodes[i].nodeType !== 1) {
					  continue;
				  }

				  if(childNodes[i] === clickedListItem) {
					  index = nodeIndex;
					  break;
				  }
				  nodeIndex++;
			  }



			  if(index >= 0) {
				  // open PhotoSwipe if valid index found
				  openPhotoSwipe( index, clickedGallery );
			  }
			  return false;
		  };

		  // parse picture index and gallery index from URL (#&pid=1&gid=2)
		  var photoswipeParseHash = function() {
			  var hash = window.location.hash.substring(1),
			  params = {};

			  if(hash.length < 5) {
				  return params;
			  }

			  var vars = hash.split('&');
			  for (var i = 0; i < vars.length; i++) {
				  if(!vars[i]) {
					  continue;
				  }
				  var pair = vars[i].split('=');
				  if(pair.length < 2) {
					  continue;
				  }
				  params[pair[0]] = pair[1];
			  }

			  if(params.gid) {
				  params.gid = parseInt(params.gid, 10);
			  }

			  return params;
		  };

		  var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {
			  var pswpElement = document.querySelectorAll('.pswp')[0],
				  gallery,
				  options,
				  items;

			  items = parseThumbnailElements(galleryElement);

			  // define options (if needed)
			  options = {

				  // define gallery index (for URL)
				  galleryUID: galleryElement.getAttribute('data-pswp-uid'),

				  getThumbBoundsFn: function(index) {
					  // See Options -> getThumbBoundsFn section of documentation for more info
					  var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail
						  pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
						  rect = thumbnail.getBoundingClientRect();

					  return {x:rect.left, y:rect.top + pageYScroll, w:rect.width};
				  }

			  };

			  // PhotoSwipe opened from URL
			  if(fromURL) {
				  if(options.galleryPIDs) {
					  // parse real index when custom PIDs are used
					  // http://photoswipe.com/documentation/faq.html#custom-pid-in-url
					  for(var j = 0; j < items.length; j++) {
						  if(items[j].pid == index) {
							  options.index = j;
							  break;
						  }
					  }
				  } else {
					  // in URL indexes start from 1
					  options.index = parseInt(index, 10) - 1;
				  }
			  } else {
				  options.index = parseInt(index, 10);
			  }

			  // exit if index not found
			  if( isNaN(options.index) ) {
				  return;
			  }

			  if(disableAnimation) {
				  options.showAnimationDuration = 0;
			  }

			  // Pass data to PhotoSwipe and initialize it
			  gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);
			  gallery.init();
		  };

		  // loop through all gallery elements and bind events
		  var galleryElements = document.querySelectorAll( gallerySelector );

		  for(var i = 0, l = galleryElements.length; i < l; i++) {
			  galleryElements[i].setAttribute('data-pswp-uid', i+1);
			  galleryElements[i].onclick = onThumbnailsClick;
		  }

		  // Parse URL and open gallery if it contains #&pid=3&gid=1
		  var hashData = photoswipeParseHash();
		  if(hashData.pid && hashData.gid) {
			  openPhotoSwipe( hashData.pid ,  galleryElements[ hashData.gid - 1 ], true, true );
		  }
		};
	</script>


</head>
<body onload="init();">
	<span class="back_top" ><button class="top_submit" onclick="go_back();">برگشت</button></span>
	<div id="ajax" class="mypreload">
		<div style="z-index: 1000; border: medium none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px; background-color: #332958; opacity: 1; cursor: default; position: fixed;overflow:visible;" class="blockUI blockOverlay"></div>
		<div style="z-index: 1011; position: fixed; padding: 0px; margin: 0px; width: 100%; top: 28%; left: 0%; text-align: center;border: medium none;overflow:visible;" class="blockUI blockMsg blockPage"><img src="images/preloader.gif"></div>
		<div style="z-index: 1012; position: fixed; padding: 0px; margin: 0px; width: 100%; top: 50%; left: 0%; text-align: center;border: medium none;overflow:visible;height:500px;" class="blockUI blockMsg blockPage"><img src="images/loading.png" width="70%"><span class="back_padding" style="width:auto;"><button class="back_submit" onclick="go_back();">برگشت به صفحه قبل</button></span></div>
	</div>
	<div class="photos_inner_hole main_content">
		<img id="gallery_toch1" class="photos_inner_head" src="images/photos_main.png">
		<div class="akhbar_inner_content_main">
			<div class="akhbar_inner_scroll">
				<div class="akhbar_inner_content" id="gallery_toch2" >
					<div class="akhbar_inner_content2">
						<h4 class="photos_title"></h4>
						<div class="my-gallery" ></div>
					</div>
				</div>

				<div class="dw_back cycle_header">
					<div class="cycles"></div>
						<a class="backbtn" href="multimedia.html"><img src="images/backbtn.png"></a>

					<div class="cycles"></div>
				</div>
			</div>
		</div>

	</div>
	
	<!-- Root element of PhotoSwipe. Must have class pswp. -->
	<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

		<!-- Background of PhotoSwipe.
			 It's a separate element, as animating opacity is faster than rgba(). -->
		<div class="pswp__bg"></div>

		<!-- Slides wrapper with overflow:hidden. -->
		<div class="pswp__scroll-wrap">

			<!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. -->
			<!-- don't modify these 3 pswp__item elements, data is added later on. -->
			<div class="pswp__container">
				<div class="pswp__item"></div>
				<div class="pswp__item"></div>
				<div class="pswp__item"></div>
			</div>

			<!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
			<div class="pswp__ui pswp__ui--hidden">

				<div class="pswp__top-bar">

					<!--  Controls are self-explanatory. Order can be changed. -->

					<div class="pswp__counter"></div>

					<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

					<!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
					<!-- element will get class pswp__preloader--active when preloader is running -->
					<div class="pswp__preloader">
						<div class="pswp__preloader__icn">
						  <div class="pswp__preloader__cut">
							<div class="pswp__preloader__donut"></div>
						  </div>
						</div>
					</div>
				</div>

				<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
					<div class="pswp__share-tooltip"></div>
				</div>

				<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
				</button>

				<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
				</button>

				<div class="pswp__caption">
					<div class="pswp__caption__center"></div>
				</div>

			  </div>

			</div>

	</div>


</body>
</html>
